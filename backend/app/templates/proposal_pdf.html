<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ proposal.title }}</title>
  <style>
    /* Basic PDF-ready CSS (keep inline for wkhtmltopdf) */
    @page { margin: 10mm; }
    body { font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color:#222; }
    .header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
    .company { font-size:18px; font-weight:700; }
    .client { font-size:14px; color:#555; }
    .meta { text-align:right; font-size:12px; color:#666; }

    table { width:100%; border-collapse:collapse; margin-top:15px; }
    th, td { padding:8px 10px; border-bottom:1px solid #e6e6e6; font-size:13px; text-align:left; }
    th { background: #f7f7f7; }
    .right { text-align:right; }
    .totals { margin-top:15px; width:100%; }
    .totals td { padding:6px; font-weight:600; }

    .notes { margin-top:30px; font-size:12px; color:#333; }
    .footer { position:fixed; bottom:10px; left:0; right:0; text-align:center; font-size:11px; color:#888; }
  </style>
</head>
<body>
  <div class="header">
    <div>
      <div class="company">{{ proposal.owner.company_name or proposal.owner.name }}</div>
      {% if proposal.owner.logo_url %}
        <img src="{{ proposal.owner.logo_url }}" alt="logo" style="height:50px;margin-top:8px" />
      {% endif %}
      <div class="client"><strong>To:</strong> {{ proposal.client_name }} {% if proposal.client_email %} | {{ proposal.client_email }}{% endif %}</div>
    </div>
    <div class="meta">
      <div><strong>Proposal:</strong> {{ proposal.title }}</div>
      <div><strong>Date:</strong> {{ proposal.created_at.strftime('%d %b %Y') }}</div>
      <div><strong>ID:</strong> {{ proposal.id }}</div>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:60%">Description</th>
        <th style="width:10%">Qty</th>
        <th style="width:15%">Unit</th>
        <th style="width:15%" class="right">Total</th>
      </tr>
    </thead>
    <tbody>
      {% for item in items %}
      <tr>
        <td>{{ item.description }}</td>
        <td>{{ item.quantity }}</td>
        <td>{{ '{:,.2f}'.format(float(item.unit_price)) }}</td>
        <td class="right">{{ '{:,.2f}'.format(float(item.total_price)) }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <table class="totals">
    <tr>
      <td style="width:70%"></td>
      <td style="width:30%">
        <table style="width:100%">
          <tr><td>Subtotal</td><td class="right">{{ '{:,.2f}'.format(float(proposal.subtotal or 0)) }}</td></tr>
          <tr><td>Tax</td><td class="right">{{ '{:,.2f}'.format(float(proposal.tax or 0)) }}</td></tr>
          <tr><td><strong>Total</strong></td><td class="right"><strong>{{ '{:,.2f}'.format(float(proposal.total_amount or 0)) }} {{ proposal.currency }}</strong></td></tr>
        </table>
      </td>
    </tr>
  </table>

  {% if proposal.notes %}
  <div class="notes">
    <h4>Terms & Notes</h4>
    <div>{{ proposal.notes|safe }}</div>
  </div>
  {% endif %}

  <div class="footer">
    Generated by YourSaaSName â€¢ professional proposals that close deals
  </div>
</body>
</html>
